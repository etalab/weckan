{% extends "site.html" %}
{% import "macros/forms.html" as forms %}

{% block title %}{{title}}{% endblock %}

{% block extra_head %}
{{ super() }}
{% assets 'forms-css' %}
<link rel="stylesheet" media="screen" href="{{ ASSET_URL }}"/>
{% endassets %}
{% endblock %}

{% block content %}
<section class="form cover">
    <div class="container"
        {% if group %}
        data-group-id="{{ group.id }}" data-group-title="{{ group.title }}"
        {% endif %}
        >

        <div class="row">
            <div class="animover col-sm-12 col-lg-offset-1 col-lg-10">
                {% if dataset %}
                <div class="page-header">
                    <h1>
                        <a href="{{ url(lang, 'dataset', dataset.name) }}"
                            title="{{ dataset.title }}">
                            {{ dataset.title }}
                        </a>
                    </h1>
                </div>
                <ul class="nav nav-pills">
                    {% for tab, label, form_url in (
                        ('description', _('Description'), 'edit'),
                        ('extras', _('Additional informations'), 'extras'),
                    ) %}
                    <li {% if active_tab == tab %}class="active"{% endif %}>
                        <a href="{{ url(lang, 'dataset', form_url, dataset.name) }}">{{ label }}</a>
                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                <div class="page-header">
                    <h1>{{ title }}</h1>
                </div>
                {% endif %}


                {% block formcontent %}
                <form class="form-horizontal validation" role="form" method="post">

                    {% for field in form %}
                    {{ forms.field(field, owner or user) }}
                    {% endfor %}

                    {{ forms.required_disclaimer() }}

                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10 text-center">
                            <button type="submit" class="btn btn-primary" title="{{ title }}">
                                {{ _('Save') }}
                            </button>

                            <a href="{{ back_url }}" class="btn btn-warning" title="{{ _('Cancel') }}">
                                {{ _('Cancel') }}
                            </a>

                            {% if dataset %}
                            <button class="btn btn-danger pull-right" title="{{ _('Delete') }}"
                                data-toggle="modal" data-target="#confirm-delete-modal">
                                {{ _('Delete') }}
                            </button>
                            {% endif %}

                        </div>
                    </div>

                </form>
                {% endblock %}
            </div>
        </div>

    </div>
</section>
{% endblock %}

{% block hiddens %}
{# Confirm delete modal #}
<div class="modal fade" id="confirm-delete-modal" tabindex="-1" role="dialog"
    aria-labelledby="confirm-delete-modal-label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="confirm-delete-modal-label">{{ _('Confirm deletion') }}</h4>
            </div>
            <div class="modal-body">
                <p>
                {{ _('You are about to delete this dataset.') }}<br/>
                {{ _('This operation is unreversible') }}
                </p>
                <p><strong>{{ _('Are you sure ?') }}</strong></p>
            </div>
            <div class="modal-footer">
                <a href="{{ delete_url }}" class="btn btn-primary postable">{{ _('Yes') }}</a>
                <button type="button" class="btn btn-warning" data-dismiss="modal">{{ _('No') }}</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascript %}
{% assets "forms-js" %}
<script src="{{ ASSET_URL}}"></script>
{% endassets %}
{% endblock %}
